<!DOCTYPE html>
<html lang="en">
<head>

        <meta charset="utf-8">

        <link rel="stylesheet" href="_css/default.css">
        <script src="_js/default.js"></script>

        <script src="_js/jquery.js"></script>

        <script src="_json/me.js"></script>
        <script src="_json/destinations.js"></script>
        <script src="_json/json.js"></script>

<!--
        <script>
          alert(JSONdestinations.destinations[1].cost);
          JSONdestinations.destinations[1].cost = "bob";
          alert(JSONdestinations.destinations[1].cost);
        </script>
-->

        <!-- START jvectormap -->
        <link rel="stylesheet" href="_js/jquery-jvectormap-2.0.3.css"/>
        <script src="_js/jquery-jvectormap-2.0.3.min.js"></script>
        <script src="_js/jquery-mousewheel.js"></script>
        <script src="_js/jquery-jvectormap-world-mill-en.js"></script>
        <script>




        $(function(){
          $('#jvectormap').vectorMap({
            map: 'world_mill'
            ,backgroundColor: '#CCC'
            ,markers : JSONdestinations["destinations"] //Assign value from the JSON array
            ,markerStyle : {
              initial : {
                fill  : '#CCC',
                stroke: '#FFF'
              } //initial
            } //markerStyle

            ,onMarkerClick: function(event, index) {
              //alert(JSONdestinations["destinations"][index].latLng[0]);

//getlocations
var locationCurrent = JSONdestinations["destinations"][JSONme["me"][0].locationCurrent].latLng;
var locationDestination = JSONdestinations["destinations"][index].latLng;

console.log("Distance from " + JSONdestinations["destinations"][JSONme["me"][0].locationCurrent].name + " to " + JSONdestinations["destinations"][index].name + " : " + calcDistance(locationCurrent[0], locationCurrent[1], locationDestination[0], locationDestination[1], "KM") + " Kilometres");

            } //onMarkerClick

          }); //$('#jvectormap').vectorMap({
        }); //$(function(){






function calcDistance(currentLat, currentLong, destinationLat, destinationLong, strUnit) {
  //Calculate distance from lat and longs

  var intResult = 0 //Value to return

  var p = 0.017453292519943295;    // Math.PI / 180
  var c = Math.cos;
  var a = 0.5 - c((destinationLat - currentLat) * p)/2 +
          c(currentLat * p) * c(destinationLat * p) *
          (1 - c((destinationLong - currentLong) * p))/2;

  var intKilometres = Math.round(12742 * Math.asin(Math.sqrt(a))).toFixed(0); // 2 * R; R = 6371 km
  var intMiles = intKilometres * 0.621371 // miles

  //determine what unit to display
  if (strUnit == "KM") intResult = intKilometres;
  else intResult = intMiles;

  return intResult

}





        </script>
        <!-- END jvectormap -->


        <title>TravelMe</title>

</head>
<body>


  <div id="jvectormap" style="width:600px; height: 350px;"></div>


<div class="divTable">
  <div class="divRow">
    <div class="divCell"></div><!-- divCell -->
  </div><!-- divRow -->
</div><!-- divTable -->


</body>
</html>
